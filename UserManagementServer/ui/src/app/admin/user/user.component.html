<app-admin></app-admin>
<div class="loading" *ngIf="loading">
    <app-loader></app-loader>
</div>
<div id="userListContainer" class="container-fluid gb-main-container" [ngClass]="{'onscreenEnabled': isOnscreenenabled()}">
    <div class="row mb-2 analytics-container" *ngIf="!loading">
        <div id="users-container" class="col">
            <div class="card-container d-flex flex-column">
                <div class="card-title font-weight-bold text-secondary">{{templateVariables.userLicensesText}}</div>
                <div class="progress-wrapper d-flex">
                    <round-progress class="d-sm-none d-md-block" [current]="licensesData.totalUsers"
                        [max]="licensesData.maxUsers" [radius]="15"></round-progress>
                    <div id="users-container-count" class="text-secondary ml-3">{{licensesData.totalUsers}}/{{licensesData.maxUsers}}</div>
                </div>
            </div>
            <span (click)="helperClick($event)" class="btn-helper-card bg-warning" placement="left" container="body" [ngbPopover]="userLicensesHelp" popoverClass="userLicensesHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
        </div>
        <div id="viewers-container" class="col" *ngIf="isviewercust">
            <div class="card-container d-flex flex-column">
                <div class="card-title font-weight-bold text-secondary">{{templateVariables.viewerLicensesText}}
                </div>
                <div class="progress-wrapper d-flex">
                    <round-progress class="d-sm-none d-md-block" [current]='licensesData.viewerLicensesUser'
                        [max]='licensesData.maxViewerLicenses' [radius]="15"></round-progress>
                    <div id="viewers-container-count" class="text-secondary ml-3">
                        {{licensesData.viewerLicensesUser}}/{{licensesData.maxViewerLicenses}}</div>
                </div>
            </div>
            <span (click)="helperClick($event)" class="btn-helper-card bg-warning" placement="left" container="body" [ngbPopover]="viewerLicensesHelp" popoverClass="viewerLicensesHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
        </div>
        <div id="wbusers-container" class="col">
            <div class="card-container d-flex flex-column">
                <div class="card-title font-weight-bold text-secondary">{{templateVariables.explorerLicenseText}}
                </div>
                <div class="progress-wrapper d-flex">
                    <round-progress class="d-sm-none d-md-block" [current]='licensesData.workbenchLicensedUsed'
                        [max]='licensesData.maxWBLicenses' [radius]="15"></round-progress>
                    <div id="wbusers-container-count" class="text-secondary ml-3">
                        {{licensesData.workbenchLicensedUsed}}/{{licensesData.maxWBLicenses}}</div>
                </div>
            </div>
            <span (click)="helperClick($event)" class="btn-helper-card bg-warning" placement="left" container="body" [ngbPopover]="explorerLicensesHelp" popoverClass="explorerLicensesHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
        </div>
        <div id="wbadmin-container" class="col">
            <div class="card-container d-flex flex-column">
                <div class="card-title font-weight-bold text-secondary">{{templateVariables.creatorLicensesText}}</div>
                <div class="progress-wrapper d-flex">
                    <round-progress class="d-sm-none d-md-block" [current]="licensesData.creatorLicensesUsed"
                        [max]="licensesData.maxCreatorLicenses" [radius]="15"></round-progress>
                    <div id="wbadmin-container-count" class="text-secondary ml-3">
                        {{licensesData.creatorLicensesUsed}}/{{licensesData.maxCreatorLicenses}}</div>
                </div>
            </div>
            <span (click)="helperClick($event)" class="btn-helper-card bg-warning" placement="left" container="body" [ngbPopover]="creatorLicensesHelp" popoverClass="creatorLicensesHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
        </div>
        <!-- <div id="admin-container" class="col">
            <div class="card-container d-flex flex-column">
                <div class="card-title font-weight-bold text-secondary">{{templateVariables.adminUsersText}}</div>
                <div class="progress-wrapper d-flex">
                    <div class="text-info font-weight-bold">{{licensesData.adminUsers}}</div>
                </div>
            </div>
        </div> -->
    </div>    
    <div class="row flex-nowrap wrapper">
        <div class="col-md-2 col-1 pl-0 pr-0 width border-right sidebar collapse"  [ngClass]="{'show': showFilter}">
            <div id="user-filter-panel" class="leftnavbar expandLeft roleFilterPanel pl-1 customScroll">
                <div class="d-flex justify-content-between px-2 bg-darker">
                <div>
                    <h6 class="text-light my-1">Filter</h6>
                </div>
                <div id="userCloseFilter" class="text-light">
                    <fa-icon id="closeFilter" title="Close Filter" [icon]="['fas','arrow-left']"
                        (click)="showFilter = !showFilter"></fa-icon>
                </div>
            </div>
            <ngb-accordion #acc="ngbAccordion" [closeOthers]="true">
                <div class="filter-data" *ngFor="let filter of userFilterData">
                    <ngb-panel *ngIf="filter.data.length">
                        <ng-template ngbPanelHeader let-opened="opened">
                            <div class="d-flex align-items-center justify-content-between">
                                <button ngbPanelToggle class="flex-fill p-0 btn btn-link text-decoration-none text-dark text-left float-left" id="filter_column_{{filter.columnName}}"><fa-icon *ngIf="!opened" class="ml-1"[icon]="['fas','angle-down']"></fa-icon><fa-icon *ngIf="opened" class="ml-1"[icon]="['fas','angle-up']"></fa-icon> {{filter.columnTitle}} <span class="badge badge-primary float-right mr-1" *ngIf="filter.appliedFilterCount > 0">{{filter.appliedFilterCount}}</span></button>
                                <!-- <button ngbPanelToggle id="filter_column_{{filter.columnName}}"
                                    class="flex-fill btn btn-sm btn-outline-secondary text-left">{{filter.columnTitle}}
                                    <span class="badge badge-secondary float-right mt-1"
                                        *ngIf="filter.appliedFilterCount > 0">{{filter.appliedFilterCount}}</span>
                                    <fa-icon *ngIf="!opened" class="float-right mr-1" [icon]="['fas','angle-down']">
                                    </fa-icon>
                                    <fa-icon *ngIf="opened" class="float-right mr-1" [icon]="['fas','angle-up']"></fa-icon>
                                </button> -->
                            </div>
                        </ng-template>
                        <ng-template ngbPanelContent>
                            <div class="" *ngIf="filter.showSearch">
                                <div class="input-group input-group-sm mb-1">
                                    <input type="text" class="form-control" id="filterSearchEmail" placeholder="Search"
                                        [(ngModel)]="filter.searchText">
                                    <div class="input-group-append">
                                        <button id="userEmailClearSearch" [disabled]="filter.searchText==''"
                                            class="btn btn-outline-danger" (click)="filter.searchText=''" type="button">
                                            <fa-icon title="Clear Search" class="mt-1" [icon]="['fas','times']"></fa-icon>
                                        </button>
                                    </div>
                                </div>
                                <div id="filterContent_{{filter.columnName}}">
                                    <div class="px-1" *ngFor="let data of getFilterData(filter)">
                                        <div class="pretty p-svg p-curve m-0">
                                            <input type="checkbox" [checked]="data.selected"
                                                (change)="data.selected = !data.selected; updateDataFilter(data.name, data.selected, filter.multiselect, filter.data, filter.columnName)" />
                                            <div class="state p-primary">
                                                <svg class="svg svg-icon" viewBox="0 0 20 20">
                                                    <path
                                                        d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                                        style="stroke: white;fill:white;"></path>
                                                </svg>
                                                <label>{{data.name}}</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-3" *ngIf="filter.searchText.length >=3 && !getFilterData(filter).length">
                                    {{templateVariables.validationMessages.noDataFound}}
                                </div>
                                <!-- <div class="no-data-msg" ng-if="!emailFilteredData.length">No Data.</div>  -->
                            </div>
                            <div id="filterContent_{{filter.columnName}}" class="" *ngIf="!filter.showSearch">
                                <div class="px-1" *ngFor="let data of filter.data"
                                    id="filterItem_{{filter.columnName}}_{{data.value}}">
                                    <div class="pretty p-svg p-curve m-0"
                                        [ngClass]="{'p-curve': filter.multiselect , 'p-round': !filter.multiselect}"
                                        (click)="data.selected = !data.selected; updateDataFilter(data.name, data.selected, filter.multiselect, filter.data, filter.columnName)">
                                        <input type="checkbox" [checked]="data.selected" />
                                        <div class="state p-primary">
                                            <svg class="svg svg-icon" viewBox="0 0 20 20">
                                                <path
                                                    d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                                    style="stroke: white;fill:white;"></path>
                                            </svg>
                                            <label>{{data.name}}</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </ngb-panel>
                </div>
            </ngb-accordion>
            </div>
        </div>
        <div class="main col-12" [ngClass]="{'animateMain': showFilter, 'animateMainFull': !showFilter}">
            <div class="filter-actions-container row d-flex align-items-center">
                <div class="col-4">
                    <div class="btn-group" role="group" *ngIf="!showFilter">
                        <button type="button" (click)="showFilter = !showFilter" id="filterButton"
                            class="btn btn-sm btn-primary gb-not-btn">
                            <fa-icon title="Filter" class="mt-1" [icon]="['fas','filter']"></fa-icon><span
                                *ngIf="filterCount > 0" class="badge badge-dark">{{filterCount}}</span>
                                <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="right" container="body" [ngbPopover]="filterPop" popoverClass="filterPop"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                        </button>
                        <button type="button" class="btn btn-sm btn-danger" *ngIf="filterCount > 0" id="filterReset"
                            (click)="resetFilter()">
                            <fa-icon title="Filter" class="mt-1" [icon]="['fas','times']"></fa-icon>
                        </button>
                    </div>
                    <div class="ml-2 btn-group" role="group">
                        <button id="quickFilterBtn_{{btn.title}}" type="button" class="btn btn-sm btn-outline-primary" [ngClass]="{'btn-selected': btn.selected}"
                            *ngFor="let btn of quickFilterButtons" (click)="applyQuickFilter(btn)">{{btn.title}}</button>
                            <span (click)="helperClick($event)" class="btn-helper-btnGrp bg-warning" placement="right" container="body" [ngbPopover]="userQuickFilterHelp" popoverClass="userQuickFilterHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                    </div>
                </div>
                <div class="col-4">
                    <span *ngIf="selectedCount>0" class="badge badge-light gb-not-btn">
                        <span id="selectAllMsg" class="mr-1"><span *ngIf="selectedCount==getUserListLength()">All </span><strong class="text-primary mr-1 ml-1">{{selectedCount}}</strong>
                            User(s) selected</span>
                        <span id="selectAcrossPages" class="mr-1 text-primary cursor-pointer" (click)="selectAcrossPages()"
                            *ngIf="selectedCount!=getUserListLength()">Select all {{getUserListLength()}} User(s)</span>
                        <span class="text-danger cursor-pointer" (click)="clearSelection()" id="clearAllSelection">Clear
                            All</span></span>
                </div>
                <div class="col-4 d-flex align-items-center justify-content-end">
                    <button id="bulkUserEdit" type="button" [disabled]="!enableBulkEdit()"
                        (click)="openModal('bulkEdit',bulkEditModal, '', '')" class="btn btn-sm btn-outline-primary float-right position-relative"
                        title={{setBulkEditTitle()}}>
                        <fa-icon [icon]="['fas','edit']"></fa-icon>
                        <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="right" container="body" [ngbPopover]="userBulkEditHelp" popoverClass="userBulkEditHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                    </button>
                    <div class="search-box-container input-group input-group-sm ml-2 mr-2">
                        <input type="text" class="form-control" id="userSearchInput" placeholder="Search"
                            [(ngModel)]="searchText" (input)="PaginationReset=true">
                        <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="left" container="body" [ngbPopover]="userGlobalSearchHelp" popoverClass="userGlobalSearchHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                        <div class="input-group-append">
                            <button [disabled]="searchText==''" id="userSearchClearText" class="btn btn-outline-danger"
                                (click)="searchText=''; PaginationReset=true" type="button">
                                <fa-icon title="Clear Search" class="mt-1" [icon]="['fas','times']"></fa-icon>
                            </button>
                        </div>
                    </div>
                    <button class="btn m-0 p-0 mt-2 position-relative" (click)="exportCSVFile()" id="downloadCSVBtn"><fa-icon title="Download CSV" [icon]="['fas','download']"></fa-icon><span (click)="helperClick($event)" class="btn-helper-iconBtn-alt bg-warning" placement="left" container="body" [ngbPopover]="userDownloadPop" popoverClass="userDownloadPop"><fa-icon [icon]="['fas','info']"></fa-icon></span></button>
                </div>
            </div>
            <div class="gb-div-table user-list-table mt-2" *ngIf="!loading" id="userListDiv">
                <div class="row" *ngIf="!getUserListFiltered().length">
                    <div class="col">
                        <div class="alert alert-danger mt-3 text-center" role="alert" id="noUsersFound">
                            <strong>{{noUsersFound}}</strong></div>
                    </div>
                </div>
                <div class="row font-weight-bold border border-left-0 border-right-0 border-top-0 table-head"
                    *ngIf="getUserListFiltered().length" id="userListTableHeader">
                    <div class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2t checkboxcell text-center">
                        <p-checkbox id="userListSelectAll" animation="smooth" shape="curve" color="primary" class="ml-1"
                            [disabled]="getActionButtonDisable('selectAll')" (click)="userToggleSelect()"
                            [checked]="allUsersSelected()" binary="true">
                            <svg p-svg class="svg-icon-green" viewBox="0 0 20 20">
                                <path
                                    d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                    style="stroke: white;fill:white;"></path>
                            </svg>
                        </p-checkbox>
                    </div>
                    <div id="userListTableHeader_{{header.name}}" class="col-1 col-md-1 col-lg-1 col-xl-1 col-sm-1 mt-2 mb-2"
                        [ngClass]="{'col2 col-md-2 col-lg-2 col-xl-2 col-sm-2': header.name == 'Email', 'text-center': header.name == 'Actions'}"
                        *ngFor="let header of templateVariables.tableHeaders" attr.type="{{ header.type }}">
                        <span *ngIf="!header.sortValue.length">{{header.name}}</span>
                        <span [ngClass]="{'sortable': header.sortValue == defaultSort.column}" *ngIf="header.sortValue.length"
                            direction="{{defaultSort.direction}}" sortable="{{header.sortValue}}"
                            (sort)="onSort($event)">{{header.name}}
                        </span>
                    </div>
                </div>
                <div id="userTableData{{i}}" class="row userTableData border border-left-0 border-right-0 border-top-0"
                    *ngFor="let user of getUserListFiltered() | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize; let i = index;">
                    <div id="userTableData_{{i}}_checkboxcell" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 checkboxcell text-center">
                        <p-checkbox animation="smooth" shape="curve" color="primary" class="ml-1" *ngIf="!user.adminUser"
                            (change)="user.selected = !user.selected;updateSelectAllValue()" [checked]="user.selected"
                            binary="true">
                            <svg p-svg class="svg-icon-green" viewBox="0 0 20 20">
                                <path
                                    d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                    style="stroke: white;fill:white;">
                                </path>
                            </svg>
                        </p-checkbox>
                    </div>
                    <div id="userTableData_{{i}}_namecell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText namecell"
                        (mouseenter)="enableTootip($event, user, 'name')">
                        {{ user.name }}
                    </div>
                    <div id="userTableData_{{i}}_emailcell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-2 col-md-2 col-lg-2 col-xl-2 mt-2 mb-2 ellipseText emailcell"
                        (mouseenter)="enableTootip($event, user.email, '')">
                        {{ user.email}}
                    </div>
                    <div id="userTableData_{{i}}_rolecell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText rolecell"
                        (mouseenter)="enableTootip($event, user.roleName, '')">
                        {{ user.roleName}}
                    </div>
                    <div id="userTableData_{{i}}_end_customercell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText end_customercell"
                        (mouseenter)="enableTootip($event, user.end_customer, '')">
                        {{ user.end_customer === 'NA' ||  !user.end_customer.length? 'All' : user.end_customer }}
                    </div>
                    <div id="userTableData_{{i}}_createdcell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText createdcell"
                        (mouseenter)="enableTootip($event, user.created_on, 'date')">
                        {{user.created_on !== 'NA' ? (user.created_on | date: 'dd/MM/yyyy HH:mm:ss') : '-'}}
                    </div>
                    <div id="userTableData_{{i}}_modifiedcell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText modifiedcell"
                        (mouseenter)="enableTootip($event, user.modified_on, 'date')">
                        {{ user.modified_on !== 'NA' ? (user.modified_on | date: 'dd/MM/yyyy HH:mm:ss') : '-' }}
                    </div>
                    <div id="userTableData_{{i}}_lastLogincell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText lastLogincell"
                        (mouseenter)="enableTootip($event, user.last_login, 'date')">
                        {{ user.last_login !== 'NA' ? (user.last_login | date: 'dd/MM/yyyy HH:mm:ss') : '-' }}
                    </div>
                    <div id="userTableData_{{i}}_activecell" [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText activecell">
                        {{ user.user_state}}
                    </div>
                    <div id="userTableData_{{i}}_is_externalcell"  [ngClass]="{'not-active': user.user_state == 'INACTIVE'}" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 ellipseText is_externalcell">
                        {{ user.is_external ? 'External' : 'Internal' }}
                    </div>
                    <div id="userTableData_{{i}}_actions-container" class="col-1 col-md-1 col-lg-1 col-xl-1 mt-2 mb-2 actions-container d-flex">
                        <button class="btn position-relative ml-1 mr-1 p-0 bg-transparent border-0" id="editUser_{{i}}" title="Edit User" (click)="openModal('user',content, 'edit', user)" [disabled]="user.user_state == 'INVITED'"><fa-icon [icon]="['fas','edit']" class="text-primary"></fa-icon></button>
                        <button class="btn position-relative ml-1 mr-1 p-0 mr-1 bg-transparent border-0" id="disableUser_{{i}}" *ngIf="user.user_state == 'ACTIVE' || user.user_state == 'INVITED'" title="Inactivate" [disabled]="user.adminUser || user.user_state == 'INVITED'" (click)="openEnableDisableUserConfirmation(user)"><fa-icon [icon]="['fas','user-check']"></fa-icon></button>
                        <button class="btn position-relative ml-1 mr-1 p-0 mr-1 bg-transparent border-0" id="enableUser_{{i}}" *ngIf="user.user_state == 'INACTIVE'" title="Activate" [disabled]="user.adminUser || user.user_state == 'INVITED'" (click)='openEnableDisableUserConfirmation(user)'><fa-icon [icon]="['fas','user-alt-slash']"></fa-icon></button>
                        <button class="btn position-relative ml-1 mr-1 p-0 mr-1 bg-transparent border-0" id="changePassword_{{i}}" title="Change Password" *ngIf="!isSSOEnabled" (click)="openModal('password',changepasswordcontent, '', user)"><fa-icon [icon]="['fas','key']"></fa-icon></button>
                        <button class="btn position-relative ml-1 mr-1 p-0 mr-1 bg-transparent border-0 delete-user" id="deleteUser_{{i}}" *ngIf="!user.adminUser" title="Delete User" (click)="openConfirmation('single', user)"><fa-icon class="delete-icon" [icon]="['fas','trash']"></fa-icon><span (click)="helperClick($event)" class="btn-helper-iconBtn-alt bg-warning" *ngIf="i==0" placement="left" container="body" [ngbPopover]="userActionHelper" popoverClass="userActionHelper"><fa-icon [icon]="['fas','info']"></fa-icon></span></button>
                    </div>
                </div>
            </div>
            <div *ngIf="!loading" class="row d-flex flex-row justify-content-between mt-3 pagination-div">
                <!-- <div class="col-2">
                    <button id="bulkUserDelete" type="button" [disabled]="getActionButtonDisable('del')"
                        (click)="openConfirmation()" class="btn btn-sm btn-outline-danger">
                        <fa-icon class="mr-2" [icon]="['fas','trash-alt']"></fa-icon>
                        <span>Delete</span>
                    </button>
                </div> -->
                <div class="col-4">
                    <span *ngIf="getUserListFiltered().length > 0" class="pt-1 d-none d-sm-inline">Page Size</span>
                    <select *ngIf="getUserListFiltered().length > 0" id="userPagesizeSelect"
                        class="form-control form-control-sm d-inline-block ml-1" style="width: auto" [(ngModel)]="pageSize">
                        <option *ngFor="let pageCount of pageValue" [ngValue]="pageCount"
                            [disabled]="getUserListFiltered().length+defaultPageSize<=pageCount">
                            {{pageCount}}</option>
                    </select>
                    <span *ngIf="getUserListFiltered().length > 0" (click)="helperClick($event)" class="btn-helper-inline bg-warning" placement="right" container="body" [ngbPopover]="pageSizePop" popoverClass="pageSizePop"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                </div>
                <div class="col-4">
                    <ngb-pagination
                        *ngIf="(getUserListFiltered().length > 0 && getUserListFiltered().length > getCollectionLength())"
                        id="paginationUser" [(page)]="page" [pageSize]="pageSize" (pageChange)="userPageChanged()"
                        [collectionSize]="getUserListFiltered().length" [ellipses]="true" [maxSize]="10" [size]="smsize">
                    </ngb-pagination><span (click)="helperClick($event)" class="btn-helper-inline bg-warning" placement="top" container="body" *ngIf="(getUserListFiltered().length > 0 && getUserListFiltered().length > getCollectionLength())" [ngbPopover]="paginationPop" popoverClass="paginationPop"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                </div>
                <div class="col-4 text-right">
                    <button id="bulkUserDelete" type="button" [disabled]="getActionButtonDisable('del')"
                        (click)="openConfirmation('multiple')" class="btn btn-sm btn-outline-danger position-relative">
                        <fa-icon class="mr-2" [icon]="['fas','trash-alt']"></fa-icon>
                        <span>Delete</span><span (click)="helperClick($event)" class="btn-helper bg-warning" placement="left" container="body" [ngbPopover]="userDeleteHelper" popoverClass="userDeleteHelper"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                    </button>
                    <button id="addUserBtn" type="button" class="btn ml-1 btn-sm btn-outline-primary float-right position-relative"
                        (click)="openModal('user',content, 'new', '');filterRoles()">
                        <fa-icon class="mr-2" [icon]="['fas','user-plus']"></fa-icon>
                        <span>Add User</span>
                        <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="left" container="body" [ngbPopover]="userAddUserHelper" popoverClass="userAddUserHelper"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- <div class="col-12"> -->

    <!--BO: Add User popup-->
    <ng-template #content let-modal>
        <div class="modal-header bg-info gb-modal-header">
            <h4 class="modal-title text-light" id="userModalBasicTitle">{{isEditMode ? 'Edit User' : 'Add User'}}</h4>
            <button type="button" class="close text-light" id="addEditUserClosemodal" aria-label="Close"
                (click)="modal.dismiss('Cross click'); licensingWarning = '';">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body d-flex add-user-popup" [ngClass]="{'onscreenEnabled': isOnscreenenabled()}">
            <div class="container-fluid">
                <form [formGroup]="userForm" (ngSubmit)="saveUser(userForm)">
                    <div class="row">
                        <div class="col-6"></div>
                        <div class="col-6 form-group user-type-container">
                            <label for="userType"></label>
                            <span>Internal</span>
                            <div class="pretty p-switch user-type-switch">
                                <input id="filterRoles" type="checkbox" formControlName="is_external"
                                    (change)="filterRoles()" />
                                <div class="state">
                                    <label></label>
                                </div>
                            </div>
                            <span>External</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Name</span>
                                </div>
                                <input id="user_firstName" class="form-control" type="text" formControlName="firstName"
                                placeholder="First Name" [ngClass]="{ 'is-invalid': submitted && f.firstName.errors }" [attr.title]="userFormHelper.fname">
                                <input id="user_lastName" class="form-control" type="text" formControlName="lastName"
                                placeholder="Last Name" [ngClass]="{ 'is-invalid': submitted && f.lastName.errors }" [attr.title]="userFormHelper.lname">
                                <div class="ml-1 mt-1" title="{{userHelpText.name}}"><fa-icon [icon]="['fas','info-circle']"></fa-icon></div>
                                <div *ngIf="submitted && f.firstName.errors" class="invalid-feedback">
                                    <div id="userNameRequired" *ngIf="f.firstName.errors.required">
                                        {{templateVariables.validationMessages.nameRequired}}</div>
                                    <div id="userNameMaxLength"
                                        *ngIf="f.firstName.errors.minlength || f.firstName.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLength}}</div>
                                    <div id="userNameInvalid" *ngIf="f.firstName.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                </div>
                                <div *ngIf="submitted && f.lastName.errors" class="invalid-feedback">
                                    <div id="userLastNameMaxLength"
                                        *ngIf="f.lastName.errors.minlength || f.lastName.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLength}}</div>
                                    <div id="userLastNameInvalid" *ngIf="f.lastName.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Email</span>
                                </div>
                                <input id="email" [attr.email]="userForm.controls.email.value" class="form-control" type="text"
                                formControlName="email" placeholder="Email"
                                [ngClass]="{ 'is-invalid': submitted && f.email.errors }"
                                [readonly]="isEditMode || isEditMode && user.adminUser" [attr.title]="userFormHelper.email">
                                <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                                    <div id="userEmailRequired" *ngIf="f.email.errors.required">
                                        {{templateVariables.validationMessages.emailRequired}}</div>
                                    <div id="userEmailExists" *ngIf="f.email.errors.duplicate">
                                        {{templateVariables.validationMessages.emailExists}}</div>
                                    <div id="userEmailInvalid" *ngIf="f.email.errors.pattern">
                                        {{templateVariables.validationMessages.invalidEmail}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group d-flex phone-number">
                            <div class="input-group input-group-sm">
                                <div class="input-group-prepend d-inline">
                                    <div class="input-group-text" id="basic-addon1">Phone</div>
                                </div>
                                <div class="input-group-prepend d-inline">
                                    <div class="input-group-text" id="basic-addon1">+</div>
                                </div>
                                <input type="text" class="form-control" placeholder="Code" formControlName="countryCode"
                                    aria-label="Country code" aria-describedby="basic-addon1" title="Country Code"
                                    (input)="setPhoneNumberValidator()"
                                    [ngClass]="{ 'is-invalid': submitted && f.countryCode.errors }" id="countryCode" [attr.title]="userFormHelper.code">
                                <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="left" container="body" [ngbPopover]="userAddUserCodeHelp" popoverClass="userAddUserCodeHelp"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                                <div *ngIf="submitted && f.countryCode.errors" class="invalid-feedback">
                                    <div id="userCountryCodeRequired" *ngIf="f.countryCode.errors.required">
                                        {{templateVariables.validationMessages.countryCodeRequired}}</div>
                                    <div id="userCountryCodeInvalid" *ngIf="f.countryCode.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                    <div id="userCountryCodeMaxLength"
                                        *ngIf="f.countryCode.errors.minlength || f.countryCode.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLengthForCountryCode}}</div>
                                </div>
                            </div>
                            <div class="m-1"> - </div>
                            <div class="d-flex">
                                <input id="phoneNumber" class="form-control form-control-sm" type="text" formControlName="phone"
                                    placeholder="Phone" [ngClass]="{ 'is-invalid': submitted && f.phone.errors }"
                                    (input)="setPhoneNumberValidator()" title="Phone Number" [attr.title]="userFormHelper.phone">
                                <div class="ml-1 mt-1" title="{{userHelpText.phone}}"><fa-icon [icon]="['fas','info-circle']"></fa-icon></div>
                                <div *ngIf="submitted && f.phone.errors" class="invalid-feedback">
                                    <div id="userPhoneRequired" *ngIf="f.phone.errors.required">
                                        {{templateVariables.validationMessages.phoneRequired}}</div>
                                    <div id="userPhoneInvalid" *ngIf="f.phone.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                    <div id="userPhoneMaxLength"
                                        *ngIf="f.phone.errors.minlength || f.phone.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLengthForPhone}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Department</span>
                                </div>
                                <input id="department" class="form-control" type="text" formControlName="department"
                                placeholder="Department" [ngClass]="{ 'is-invalid': submitted && f.department.errors }" [attr.title]="userFormHelper.dept">
                                <div *ngIf="submitted && f.department.errors" class="invalid-feedback">
                                    <div id="userDeptInvalid" *ngIf="f.department.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                    <div id="userDeptMaxLength"
                                        *ngIf="f.department.errors.minlength || f.department.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLength}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">State</span>
                                </div>
                                <input id="state" class="form-control" type="text" formControlName="state"
                                placeholder="State" [ngClass]="{ 'is-invalid': submitted && f.state.errors }" [attr.title]="userFormHelper.state">
                                <div *ngIf="submitted && f.state.errors" class="invalid-feedback">
                                    <div id="userStateInvalid" *ngIf="f.state.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                    <div id="userStateMaxLength"
                                        *ngIf="f.state.errors.minlength || f.state.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLength}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">City</span>
                                </div>
                                <input id="city" class="form-control" type="text" formControlName="city" placeholder="City"
                                [ngClass]="{ 'is-invalid': submitted && f.city.errors }" [attr.title]="userFormHelper.city">
                                <div *ngIf="submitted && f.city.errors" class="invalid-feedback">
                                    <div id="userCityInvalid" *ngIf="f.city.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                    <div id="userCityMaxLength" *ngIf="f.city.errors.minlength || f.city.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLength}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Country</span>
                                </div>
                                <input id="country" class="form-control" type="text" formControlName="country"
                                placeholder="Country" [ngClass]="{ 'is-invalid': submitted && f.country.errors }" [attr.title]="userFormHelper.country">
                                <div *ngIf="submitted && f.country.errors" class="invalid-feedback">
                                    <div id="userCountryInvalid" *ngIf="f.country.errors.pattern">
                                        {{templateVariables.validationMessages.notValid}}</div>
                                    <div id="userCountryMaxLength"
                                        *ngIf="f.country.errors.minlength || f.country.errors.maxlength">
                                        {{templateVariables.validationMessages.minMaxLength}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Role</span>
                                </div>
                                <select class="custom-select" id="userRoleSelect" formControlName="role"
                                (change)="errorMessage = '';getProductsForRole(userForm);getEndCustomerList(); setEndCustomerValidator()"
                                [ngClass]="{ 'is-invalid': submitted && f.role.errors, 'disabled': isEditMode && user.adminUser }" [attr.title]="userFormHelper.role">
                                <option value='' disabled>Select Role</option>
                                <option *ngFor="let role of roles" [ngValue]="role.name">
                                    {{role.disName}}
                                </option>
                                </select>
                                <div *ngIf="submitted && f.role.errors" class="invalid-feedback">
                                    <div id="userRoleRequired" *ngIf="f.role.errors.required">
                                        {{templateVariables.validationMessages.roleRequired}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Default Product</span>
                                </div>
                                <select id="userProdSelect" class="custom-select" formControlName="default_prod"
                                (change)="getEndCustomerList(); setEndCustomerValidator()"
                                [ngClass]="{ 'is-invalid': submitted && f.default_prod.errors }" [attr.disabled]="userForm.value.role == '' ? 'disabled': null" [attr.title]="userFormHelper.defProd">
                                <option value='' disabled>Select Default Product</option>
                                <option *ngFor="let product of prodList" [ngValue]="product.mps_def">
                                    {{product.name}}
                                </option>
                                </select>
                                <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="right" container="body" [ngbPopover]="addUserDefProd" popoverClass="addUserDefProd"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                                <div *ngIf="submitted && f.default_prod.errors" class="invalid-feedback">
                                    <div id="userProductRequired" *ngIf="f.default_prod.errors.required">
                                        {{templateVariables.validationMessages.productRequired}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 form-group">
                            <div class="input-group input-group-sm">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">System Group</span>
                                </div>
                                <select id="userEndCustomerSelect" class="custom-select" formControlName="end_customer"
                                [ngClass]="{ 'is-invalid': submitted && f.end_customer.errors }" (change)="checkGroupChanges()" [attr.disabled]="(userForm.value.default_prod == '') ? 'disabled': null">
                                <option value='' disabled>Select System Group</option>
                                <option *ngFor="let endCustomer of endCustomerList" [ngValue]="endCustomer">
                                    {{endCustomer}}
                                </option>
                                </select>
                                <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="right" container="body" [ngbPopover]="addUserEndCust" popoverClass="addUserEndCust"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                                <div *ngIf="submitted && f.end_customer.errors" class="invalid-feedback">
                                    <div id="userEndcustomerRequired" *ngIf="f.end_customer.errors.required">
                                        {{templateVariables.validationMessages.endCustomerRequired}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <!-- <div class="pretty p-svg p-curve m-0" >
                                <input type="checkbox" formControlName="report_usage"/>
                                <div class="state p-primary">
                                    <svg class="svg svg-icon" viewBox="0 0 20 20">
                                        <path
                                            d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                            style="stroke: white;fill:white;"></path>
                                    </svg>
                                    <label>Report Usage</label>
                                </div>
                            </div> -->
                        </div>
                        <div class="col-6 form-group notification-cont" *ngIf="isEditMode">
                            <div class="pretty p-svg p-curve m-0">
                                <input type="checkbox" formControlName="sendNotification" [checked]="sendNotification" [attr.disabled]="disableUserNotificationCheckbox"/>
                                <div class="state p-info">
                                    <svg class="svg svg-icon" viewBox="0 0 20 20">
                                        <path
                                            d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                            style="stroke: white;fill:white;"></path>
                                    </svg>
                                    <label class="text-info mr-2">Notify user of System Group change</label>
                                </div>
                            </div>
                            <div class="ml-1" title="System Group change will impact the user's rule subscriptions. Check this option to send an e-mail notification to this user regarding System Group change."><fa-icon [icon]="['fas','info-circle']"></fa-icon></div>
                        </div>
                    </div>
                    <hr>
                    <div class="row footer-container pb-1">
                        <div class="col-10">
                            <div class="w-100">
                                <div class="badge badge-info" role="alert" *ngIf="licensingWarning != ''" id="licensingWarning">{{licensingWarning}}</div>
                            </div>
                            <div class="w-100">
                                <div id="addUserErrorMessage" class="badge badge-danger" *ngIf="errorMessage" [innerHTML]="errorMessage">{{errorMessage}}</div>
                            </div>
                        </div>
                        <div class="col-2 d-flex justify-content-end">
                            <button type="button" class="btn btn-sm btn-outline-danger mr-1" id="addUserCancelButton" aria-label="Close" (click)="closeUserModal()">Cancel</button>
                            <button id="saveUserBtn" type="submit" class="btn btn-sm btn-outline-primary" [disabled]="!userForm.dirty">Save</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </ng-template>
    <!--EO: Add User popup-->

    <!--BO: Change Password popup-->
    <ng-template #changepasswordcontent let-modal>
        <div class="modal-header bg-info gb-modal-header">
            <h4 class="modal-title text-light">Change Password</h4>
            <button type="button" class="close text-light" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body d-flex change-password-popup">
            <div class="container-fluid">
                <form [formGroup]="changePasswordForm" (ngSubmit)="savePassword(changePasswordForm)">
                    <div class="row">
                        <div class="col-6 form-group">
                            <label for="resetPassPass">Password</label>
                            <input id="password" class="form-control" formControlName="password" type="password"
                                placeholder="New Password" maxlength="40" (input)="resetPassError = ''">
                            <!-- <div *ngIf="submitted && p.password.errors" class="invalid-feedback">
                                <div *ngIf="p.password.errors.required">
                                    {{templateVariables.validationMessages.passwordRequired}}</div>
                            </div> -->
                        </div>
                        <div class="col-6 form-group">
                            <label for="resetPassPass">Confirm Password</label>
                            <input id="confirmPassword" class="form-control" formControlName="confirmPassword"
                                type="password" placeholder="Confirm Password" maxlength="40" (input)="resetPassError = ''">
                            <!-- <div *ngIf="submitted && p.confirmPassword.errors" class="invalid-feedback">
                                <div *ngIf="p.confirmPassword.errors.required">
                                    {{templateVariables.validationMessages.confirmPasswordRequired}}</div>
                            </div> -->
                        </div>
                    </div>
                    <div id="admin-password-instruction-container" class="admin-password-instruction-container">
                        <div>
                            <label class="ml-3">{{templateVariables.validationMessages.passwordInstruction}}</label>
                        </div>
                        <ul class="password-instructions-list">
                            <li>{{templateVariables.validationMessages.passwordMinCharacterLimit}} </li>
                            <li>{{templateVariables.validationMessages.passwordMaxCharacterLimit}} </li>
                            <li>{{templateVariables.validationMessages.passwordInstructionText}}</li>
                            <li>{{templateVariables.validationMessages.passwordInstructionText1}}<br>
                                -{{templateVariables.validationMessages.passwordInstructionSubText}} <br>
                                -{{templateVariables.validationMessages.passwordInstructionSubText1}}<br>
                                -{{templateVariables.validationMessages.passwordInstructionSubText2}}<br>
                                -{{templateVariables.validationMessages.passwordInstructionSubText3}}
                            </li>
                        </ul>
                    </div>
                    <hr>
                    <div class="row footer-container p-1">
                        <div class="col-11">
                            <span id="changePasswordErrorMessage"
                                class="error-text text-danger">{{resetPassError}}</span>
                        </div>
                        <div class="col-1">
                            <button id="savePasswordBtn" type="submit" class="btn btn-sm btn-outline-primary"
                                [disabled]="changePasswordForm.invalid">Save</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </ng-template>
    <!--EO: Change Password popup-->

    <!--BO: Change Bulk Edit popup-->
    <ng-template #bulkEditModal let-modal>
        <div class="modal-header bg-info gb-modal-header">
            <h4 class="modal-title text-light" id="bulkEditTitle">Edit Users</h4>
            <h6 class="modal-sub-title text-light">(Applicable to Active/Inactive users only)</h6>
            <button type="button" class="close text-light" id="bulkEditClosemodal" aria-label="Close"
                (click)="modal.dismiss('Cross click'); licensingWarning = ''; bulkEditFlag=false">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body d-flex bulk-edit-user-popup" [ngClass]="{'onscreenEnabled': isOnscreenenabled()}">
            <div class="container-fluid">
                <span class="font-weight-bold text-danger" *ngIf="bulkSelectedUsers.length > 1">Editing
                    {{bulkSelectedUsers.length}} users</span>
                <form [formGroup]="bulkEditForm" (ngSubmit)="saveBulkEdit(bulkEditForm)">
                    <div class="row">
                        <div class="card mt-3 mb-4">
                            <div class="card-header font-weight-bold">Edit Role</div>
                            <div class="card-body row pb-0">
                                <div class="col-6 form-group">
                                    <div class="input-group input-group-sm">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Role</span>
                                        </div>
                                        <select class="custom-select" id="bulkRoleSelect" formControlName="role"
                                        (change)="getProductsForRole(bulkEditForm); errorMessage ='';">
                                            <option value=''>Select Role</option>
                                            <option *ngFor="let role of roles" [ngValue]="role.name">
                                                {{role.disName}}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-6 form-group">
                                    <div class="input-group input-group-sm">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Default Product</span>
                                        </div>
                                        <select class="form-control" id="bulkProductSelect" formControlName="product"
                                        [ngClass]="{'is-invalid': submitted && b.product.errors}" [attr.disabled]="bulkEditForm.value.role == ''? 'disabled': null" (change)="getEndCustomerListForBulkEdit()">
                                            <option value='' disabled>Select Default Product</option>
                                            <option *ngFor="let product of prodList" [ngValue]="product.mps_def">
                                                {{product.name}}</option>
                                        </select>
                                        <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="left" container="body" [ngbPopover]="bulkUserDefProdCust" popoverClass="bulkUserDefProdCust"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                                        <div *ngIf="submitted && b.product.errors" class="invalid-feedback">
                                            <div id="bulkEditProductRequired" *ngIf="b.product.errors.required">
                                                {{templateVariables.validationMessages.productRequired}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bulk-edit-customer row">
                                <div class="col-6 form-group">
                                    <div class="input-group input-group-sm">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">System Group</span>
                                        </div>
                                        <select id="bulkEndCustomerSelect" class="custom-select" formControlName="end_customer"
                                        [ngClass]="{ 'is-invalid': submitted && b.end_customer.errors }" [attr.disabled]="(bulkEditForm.value.product == '') ? 'disabled': null">
                                            <option value='' disabled>Select System Group</option>
                                            <option *ngFor="let endCustomer of endCustomerList" [ngValue]="endCustomer">
                                                {{endCustomer}}
                                            </option>
                                        </select>
                                        <span (click)="helperClick($event)" class="btn-helper bg-warning" placement="right" container="body" [ngbPopover]="bulkUserEndCust" popoverClass="bulkUserEndCust"><fa-icon [icon]="['fas','info']"></fa-icon></span>
                                        <div *ngIf="submitted && b.end_customer.errors" class="invalid-feedback">
                                            <div id="bulkEditEndCustomerRequired" *ngIf="b.end_customer.errors.required">
                                                {{templateVariables.validationMessages.endCustomerRequired}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bulk-edit-customer row">
                                <div class="col-6 form-group notification-cont">
                                    <div class="pretty p-svg p-curve">
                                        <input type="checkbox" formControlName="sendNotification" [attr.disabled]="bulkEditForm.value.role == ''? 'disabled': null"/>
                                        <div class="state p-info">
                                            <svg class="svg svg-icon" viewBox="0 0 20 20">
                                                <path
                                                    d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z"
                                                    style="stroke: white;fill:white;"></path>
                                            </svg>
                                            <label class="text-info">Notify user(s) of System Group change</label>
                                        </div>
                                    </div>
                                    <div class="ml-1" title="System Group change will impact the rule subscriptions of all the selected users. Check this option to send an e-mail notification to the selected users regarding System Group change."><fa-icon [icon]="['fas','info-circle']"></fa-icon></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" *ngIf="!isSSOEnabled">
                        <div class="card mb-4">
                            <div class="card-header font-weight-bold">Change Password</div>
                            <div class="card-body row">
                                <div class="col-6 form-group">
                                    <div class="input-group input-group-sm">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Password</span>
                                        </div>
                                        <input id="bulkEditPassword" class="form-control" type="password"
                                        formControlName="password" placeholder="New Password" maxlength="40" (input)="resetPassError = ''">
                                    </div>
                                    <!-- <div *ngIf="submitted && b.password.errors" class="invalid-feedback">
                                        <div id="bulkEditPasswordRequired" *ngIf="b.password.errors.required">
                                            {{templateVariables.validationMessages.passwordRequired}}</div>
                                    </div> -->
                                </div>
                                <div class="col-6 form-group">
                                    <div class="input-group input-group-sm">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Confirm Password</span>
                                        </div>
                                        <input id="bulkEditConfirmPassword" class="form-control" type="password"
                                        formControlName="confirmPassword" placeholder="Confirm Password" maxlength="40"
                                        (input)="resetPassError = ''">
                                    </div>
                                    <!-- <div *ngIf="submitted && b.confirmPassword.errors" class="invalid-feedback">
                                        <div id="bulkEditConfirmPasswordRequired"
                                            *ngIf="b.confirmPassword.errors.required">
                                            {{templateVariables.validationMessages.confirmPasswordRequired}}</div>
                                    </div> -->
                                </div>
                                <span id="passErrorMsg" class="error-text text-danger ml-3">{{resetPassError}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="card mb-4">
                            <div class="card-header font-weight-bold">Activate/Inactivate User</div>
                            <div class="card-body row">
                                <div class="col-2" *ngFor="let option of bulkEditEnableOptions">
                                    <div class="form-check form-check-inline">
                                        <div class="pretty p-default p-round">
                                            <input id="bulkEditStatus_{{option.value}}" type="radio"
                                                value={{option.value}} name="active" formControlName="active" />
                                            <div class="state">
                                                <label>{{option.title}}</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="row footer-container p-1">
                        <div class="col-10">
                            <div class="w-100">
                                <div class="badge badge-info" id="licensingWarning" role="alert" *ngIf="licensingWarning != ''">{{licensingWarning}}</div>
                            </div>
                            <div class="w-100">
                                <div id="bulkEditErrorMessage" class="badge badge-danger text-left" *ngIf="errorMessage" [innerHTML]="errorMessage">{{errorMessage}}</div>
                            </div>
                        </div>
                        <div class="col-2 d-flex justify-content-end">
                            <button id="bulkEditSave" type="submit" class="btn btn-sm btn-outline-primary"
                                [disabled]="!bulkEditForm.value.role.length && (!bulkEditForm.value.password.length || !bulkEditForm.value.confirmPassword.length) && !bulkEditForm.value.active.length">Save</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </ng-template>

    <!--EO: Change Bulk Edit popup-->
<!-- Helper Templates for HTML Content-->
<ng-template #userLicensesHelp><div [innerHTML]="onscreenConst.userLicensesHelp"></div></ng-template>
<ng-template #viewerLicensesHelp><div [innerHTML]="onscreenConst.viewerLicensesHelp"></div></ng-template>
<ng-template #explorerLicensesHelp><div [innerHTML]="onscreenConst.explorerLicensesHelp"></div></ng-template>
<ng-template #creatorLicensesHelp><div [innerHTML]="onscreenConst.creatorLicensesHelp"></div></ng-template>
<ng-template #filterPop><div [innerHTML]="onscreenConst.userFilter"></div></ng-template>
<ng-template #userQuickFilterHelp><div [innerHTML]="onscreenConst.userQuickFilterHelp"></div></ng-template>
<ng-template #userBulkEditHelp><div [innerHTML]="onscreenConst.userBulkEditHelp"></div></ng-template>
<ng-template #userGlobalSearchHelp><div [innerHTML]="onscreenConst.userGlobalSearchHelp"></div></ng-template>
<ng-template #userDownloadPop><div [innerHTML]="onscreenConst.userDownloadPop"></div></ng-template>
<ng-template #userActionHelper><div [innerHTML]="onscreenConst.userActionHelper"></div></ng-template>
<ng-template #userChangePasswordHelper><div [innerHTML]="onscreenConst.userChangePasswordHelper"></div></ng-template>
<ng-template #paginationPop><div [innerHTML]="onscreenConst.roleListPagination"></div></ng-template>
<ng-template #pageSizePop><div [innerHTML]="onscreenConst.roleListPageSize"></div></ng-template>
<ng-template #userDeleteHelper><div [innerHTML]="onscreenConst.userDeleteHelper"></div></ng-template>
<ng-template #userAddUserHelper><div [innerHTML]="onscreenConst.userAddUserHelper"></div></ng-template>
<ng-template #userAddUserCodeHelp><div [innerHTML]="onscreenConst.userAddUserCodeHelp"></div></ng-template>
<ng-template #addUserDefProd><div [innerHTML]="onscreenConst.addUserDefProd"></div></ng-template>
<ng-template #addUserEndCust><div [innerHTML]="onscreenConst.addUserEndCust"></div></ng-template>
<ng-template #bulkUserDefProdCust><div [innerHTML]="onscreenConst.bulkUserDefProdCust"></div></ng-template>
<ng-template #bulkUserEndCust><div [innerHTML]="onscreenConst.bulkUserEndCust"></div></ng-template>
