<!DOCTYPE html><html ng-app="internalLoginApp"><head><meta charset="utf-8"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="-1"><meta charset="utf-8"><meta name="generator" content="Glassbeam"><meta name="dcterms.created" content="Mon, 17 Aug 2015 11:42:01 GMT"><meta name="description" content=""><meta name="keywords" content=""><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Glassbeam</title><link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon"><link rel="stylesheet" type="text/css" href="/apps/app/lib/bootstrap-4.0.0/css/bootstrap.min.css"><link rel="stylesheet" href="/apps/app/lib/font-awesome/css/font-awesome.min.css"><link href="/apps/app/admin/css/internal/login.css" type="text/css" rel="stylesheet"><!--[if IE]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="/apps/app/lib/xdomain/xdomain.js"></script></head><body class="page-user" ng-controller="internalLoginCtrl" novalidate ng-cloak><div class="container"><div class="row" id="loginFormWrap"><div class="col-4"></div><div class="col-4 effect8" id="loginForm"><div class="text-center" href="#"><img ng-src="{{logo}}" alt="" ng-show="logo"></div><h5 class="text-center margin-top">Customer Management</h5><form class="row"><div class="input-group"><div class="input-group-addon"><i class="fa fa-user-circle-o" aria-hidden="true"></i></div><input id="internalLoginUser" type="text" class="form-control" required="required" ng-change="loginError = false" ng-model="internalLoginUser" placeholder="Username"></div><div class="input-group margin-top"><div class="input-group-addon"><i class="fa fa-key" aria-hidden="true"></i></div><input type="password" class="form-control" ng-change="loginError = false" required="required" ng-model="internalLoginPass" id="inlineFormInputGroup" placeholder="Password"></div><div class="alert alert-danger margin-top" ng-show="loginError"><strong>Login Failed!</strong> Please check username and password.</div><button type="submit" ng-click="login()" class="btn btn-block btn-primary margin-top">Login</button></form></div><div class="col-4"></div></div></div><div class="loader" ng-show="data_loading"><div class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div></body><script src="/apps/app/lib/jquery/jquery.min.js"></script><script src="/apps/app/lib/bootstrap-4.0.0/js/bootstrap.bundle.min.js"></script><script src="/apps/app/lib/angular/angular.min.js"></script><script src="/apps/app/lib/ng-table/ng-table.js"></script><script src="/apps/app/lib/ng-draggable/ngDraggable.js"></script><script src="/apps/app/lib/angular/angular-cookies.min.js"></script><script src="/apps/app/lib/angular/angular-animate.min.js"></script><script src="/apps/app/lib/angular/angular-route.min.js"></script><script src="/apps/app/lib/bootstrap-3.1/js/ui-bootstrap-tpls-0.10.0.min.js"></script><script>window.onload = function() {
    document.getElementById("internalLoginUser").focus();
};
//App.JS
(function(){
'use strict';

angular.module('internalLoginApp', [
  'internalLoginApp.controllers',
  'internalLoginApp.services',
  //'ui.bootstrap',
  'ngCookies',
  'ngDraggable',
  'ngAnimate',
  'ngRoute',
  'ngTable'
])
.config(function($routeProvider) {
    var urlpart = "";
    if(window.location.href.indexOf('/admin') == -1){
      urlpart = "admin/";
    }
    })
})();

window.getCookie = function(name) {
  match = document.cookie.match(new RegExp(name + '=([^;]+)'));
  if (match) return match[1];
}
//App.js Ends
//Controller.js Starts
// Controller to handle the change of page
angular.module('internalLoginApp.controllers', ['ngDraggable'])
.controller('MainCtrl', ['$scope', '$location', 'internalLoginService',
    function($scope, $location, internalLoginService) {
        angular.element(window.document)[0].title = GlobalMessages.getValue('PAGE_TITLE');
        $scope.logo = "";
        $scope.logo_url = "";
        $scope.logo_url = '/apps/app/login/images/logo.png';
        $scope.logo = '/apps/app/login/images/logo.png';
    }
])
.controller('internalLoginCtrl', ['$scope', '$location', 'internalLoginService', '$window','$document',
    function($scope, $location, internalLoginService, $window, $document) {
        $scope.logo_url = '/apps/app/login/images/logo.png';
        $scope.logo = '/apps/app/login/images/logo.png';
        $scope.data_loading = false;
        $scope.loginError = false;
        
        $scope.login = function () {
          if($scope.internalLoginUser.length == 0 || $scope.internalLoginPass.length == 0){
          }else {
            $scope.data_loading = true;
            var param = {
              "email":$scope.internalLoginUser,
              "password":$scope.internalLoginPass
            }
            internalLoginService.login(param).then(function (response) {
              $window.location.href = '/apps/app/admin/managecustomer.html';
            },function(error){
              $scope.data_loading = false;
              $scope.loginError = true;
            });
          }
        };
    }
])
.controller('MessageCtrl', ['$scope',
    function($scope) {

    }
])
//controller.js ends
//Service.js Starts
angular.module('internalLoginApp.services', [])
.factory('internalLoginService', ['$http','$cookieStore', '$cookies','$window','$location',
function($http, $cookieStore, $cookies, $window, $location) {
    var config = {
        'method': "GET",
        'url' : "/apps/config/uiconfig.json"
    }
    $http(config).success(function (data, status, headers, config) {
      var uiConfig = {};
        if(data) {
            uiConfig = data;
            var umsDomain = "umsDomain=" +uiConfig["umsDomain"];
            var domain = $location.host().split(/\.(.+)?/)[1];
            document.cookie = umsDomain+";domain="+domain+";path=/";         
        }
    });
    var umsDomain = getCookie('umsDomain'); if(umsDomain){
        var tArray = umsDomain.split('/');
        var version = tArray.pop();
        var slaves = {};
        slaves[tArray.join("/")]= "/"+version+"/xproxy";
        xdomain.slaves(slaves);
    };
    //var infoserverInternalDomain = GlobalService.getVal('infoserverInternalDomain');
    var pagesId = [];//'gbAdminForm', 'gbSelectDomainForm', 'sendEmail', 'gbFirstTimeForm', 'gbForgotForm'];

    return {
        login : function(param) {
            var domain = $location.host().split(/\.(.+)?/)[1];
            document.cookie = "adminUserName=" +param.email+";domain="+domain+";path=/";
            return $http.post(getCookie('umsDomain') + "/aa/login", param);
        },
    };
}])
//Service.js Ends</script></html>