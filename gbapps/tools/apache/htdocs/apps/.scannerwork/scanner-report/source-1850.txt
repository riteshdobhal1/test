<div class="container-fluid padding-0" ng-controller="RulesListCtrl" style="background-color: #fff">
    <div class="loading height-450" sly-show="info.rulesLoading"></div>
	<div class="row-fluid" ng-hide="info.rulesLoading">
		<div class="col-sm-12 table-responsive" id="rulesListTableDiv">
		    <div class="gb-rules-msg-block" ng-if="!!info.rulesListMsg['type']" gb-outside-click="clearMessage()">
                <div class="alert padding-0 text-align-center margin-btm-0" ng-class="{'alert-success': info.rulesListMsg['type'] == 'success', 'alert-danger': info.rulesListMsg['type'] == 'failure'}" ng-bind-html="renderHtml(info.rulesListMsg['msg'])"></div>
            </div>
            <!-- <div>
                <span class="pull-right">
                    <a ng-click="openTestHistoryModal()" class="gb-rules-link">Show Test History</a>
                </span>
            </div> -->
			<table ng-table="tableParams" show-filter="true" class="table table-hover table-bordered margin-btm-0" >
				<thead class="font-size-10">
					<tr class="border-top-bbb" ng-class="{'border-btm-ddd': tableParams.data.length == 0}">
						<th width="30" style="text-align:left">
						<input type="checkbox" class="margin-0" ng-model="info.selectAll" title="{{!!info.selectAll ? 'Unselect All' : 'Select All'}}" ng-change="checkSelectAll()" ng-checked="info.selectAll"/>
						</th>
						<th class="sortable" ng-class="{
						'sort-asc': tableParams.isSortBy(column.field, 'asc'),
						'sort-desc': tableParams.isSortBy(column.field, 'desc')
						}" style="text-align:left" ng-repeat="column in columns track by $index" ng-click="sortColumn(column.field)">
						<div class="gb-inline-flex width-100-per" >
							<span class="white-space-normal gb-rules-list-filter-btn" ng-hide="column.field =='label' || column.field =='description' || column.field =='author' || column.field =='rule_name'"> <span class="line-height-25 margin-right-8">{{column.title}}</span>
								<button ng-attr-title="{{!column.filterString ? 'Filter' : column.filterString}}" class="btn btn-xs dropdown-toggle gb-rules-filter-btn">
									<span class="pull-left padding-top-btm-3 text-align-left font-size-10">&nbsp;{{!column.filterString ? 'Filter' : (column.filterString | cut:false:3:'..')}}</span>
									<span class="caret pull-right margin-top-9"></span>
								</button>
								<ul ng-if="!$last" class="dropdown-menu gb-rules-filter-dropdown" ng-class="{'dropdown-menu-right': !$first}" role="menu" ng-click="$event.stopPropagation()">
									<li ng-repeat="item in rulesList | unique: column.field track by $index">
										<label class="checkbox-inline">
											<input type="checkbox" ng-model="info[column.field][item[column.field]]" ng-change="changeFilter(column, item[column.field])">
											<span title="{{item[column.field]}}">{{item[column.field] | cut:false:15:'...'}}</span> </label>
									</li>
								</ul>
								<ul ng-if="$last" class="dropdown-menu dropdown-menu-right gb-rules-filter-dropdown" role="menu" ng-click="$event.stopPropagation()">
                                    <li ng-repeat="item in rulesList | unique: column.field track by $index">
                                        <label class="checkbox-inline">
                                            <input type="checkbox" ng-model="info[column.field][item[column.field]]" ng-change="changeFilter(column, item[column.field])">
                                            <span title="{{(item[column.field] == info.supportedStatus.Enabled ? 'Enabled' : (item[column.field] == info.supportedStatus.Disabled ? 'Disabled' : 'Draft'))}}">{{(item[column.field] == info.supportedStatus.Enabled ? 'Enabled' : (item[column.field] == info.supportedStatus.Disabled ? 'Disabled' : 'Draft')) | cut:false:15:'...'}}</span> </label>
                                    </li>
                                </ul>
							</span>							
							<span class="white-space-normal" ng-if="column.field == 'label' || column.field == 'description' || column.field == 'author' || column.field == 'rule_name'">{{column.title}}&nbsp;
								<input type="text" ng-model="info[column.field]" ng-change="searchRule(column.field)" class="display-inline-block width-80 margin-top-1 font-weight-100" placeholder="Search {{column.title}}"/>
							</span>

							</span>
						</div></th>
					</tr>
				</thead>
				<tbody class="font-size-10">
					<tr ng-repeat="rule in $data track by $index"
					ng-class="{
					'gb-rules-enabled': rule[columns[columns.length - 1].field] == info.supportedStatus.Enabled,
					'gb-rules-disabled': rule[columns[columns.length - 1].field] == info.supportedStatus.Disabled,
					'gb-rules-draft': rule[columns[columns.length - 1].field] == info.supportedStatus.Draft
					}"
					ng-mouseenter="rule.showOptions = true;" ng-mouseleave="rule.showOptions = false;">
						
						<td>
							<input type="checkbox" class="margin-0" ng-model="rule.selected" ng-disabled="rule[columns[columns.length - 1].field] != info.supportedStatus.Enabled" ng-change="checkRulesSelection(rule)" />
						</td>
						
						<td ng-repeat="column in columns track by $index">
						    <span ng-if="$last && (rule[column.field] == info.supportedStatus.Enabled || rule[column.field] == info.supportedStatus.Disabled)" ng-show="!!rule.showOptions" ng-click="enableDisableRule(rule, column.field)" title="{{rule[column.field] == info.supportedStatus.Enabled ? 'Disable' : 'Enable'}}"  class="gb-rules-row-icon gb-rules-2nd-last-icon" ng-class="{'icon-minus': rule[column.field] == info.supportedStatus.Enabled, 'gb-rules-disable-icon': rule[column.field] == info.supportedStatus.Enabled, 'icon-checkmark': rule[column.field] == info.supportedStatus.Disabled, 'gb-rules-enable-icon': rule[column.field] == info.supportedStatus.Disabled}"></span>
						    <span ng-if="$last && rule[column.field] == info.supportedStatus.Draft" ng-show="!!rule.showOptions" ng-click="testRule(rule)" title="Test" class="gb-rules-row-icon gb-rules-2nd-last-icon icon-lab gb-rules-test-icon"></span>
						    <span ng-if="$last" ng-show="!!rule.showOptions" title="Edit" class="icon-pencil gb-rules-row-icon gb-rules-edit-icon gb-rules-last-icon" ng-click="editRule(rule)"></span>
						    
						    <!-- <span ng-if="$last" ng-show="!!rule.showOptions" title="Delete" class="icon-cancel-circle gb-rules-row-icon gb-rules-delete-icon gb-rules-last-icon" ng-click="deleteRule(rule)"></span> -->
						    <span ng-if="!$last" title="{{rule[column.field]}}">{{!!rule[column.field] ? rule[column.field] : '---' | cut:false:25:'...'}}</span>
						    <span ng-if="$last" title="{{rule[column.field]}}">{{(rule[column.field] == info.supportedStatus.Enabled ? 'Enabled' : (rule[column.field] == info.supportedStatus.Disabled ? 'Disabled' : 'Draft')) | cut:false:25:'...'}}</span>
						</td>
					</tr>
				</tbody>
			</table>
			<div class="font-size-12 font-weight-bold padding-btm-150 padding-top-150 text-align-center border-left-ddd" ng-if="tableParams.data.length == 0">
				No records found
			</div>
		</div>
	</div>
	<div class="row-fluid" ng-hide="info.rulesLoading">
		<div class="col-sm-12">
			<div class="gb-rules-table-footer padding-top-3">
				<span class="page-count-list font-size-10" ng-if="!!tableParams.data.length"> Show
					<div class="form-inline page-count-form">
						<select class="input-xs page-count-box margin-left-0" ng-model="info.page.count" ng-change="changePageSize()">>
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="30">30</option>
                            <option value="40">40</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
					</div> </span>
				<a class="margin-left-20" ng-class="{'pagination-icon-disabled': !checkAppliedFilters()}" title="Clear Applied Filters" ng-click="clearAppliedFilters()"><span class="icon-loop2"></span></a>

				<span class="gb-pagination display-inline-block gb-rules-pagination margin-left-13"> <a class="icon-previous2 pagination-icon" title="First Page" ng-click="firstPage()" ng-class="{'pagination-icon-disabled': (info.page['current'] <= 1)}"></a> <a class="icon-arrow-left7 pagination-icon" title="Previous Page" ng-click="prevPage()" ng-class="{'pagination-icon-disabled': (info.page['current'] <= 1)}"></a> <!-- <pre class="gb-pagination-msg">1 - 100 of 100</pre> --> 					<pre class="gb-pagination-msg" sly-show="info.page['current'] < info.page['pages']">{{(info.page['current'] - 1) * info.page['count'] + 1}} - {{(info.page['current'] - 1) * info.page['count'] + info.page['count']}} of {{info.page['total']}}</pre> 					<pre class="gb-pagination-msg" sly-show="info.page['current'] == info.page['pages']">{{(info.page['current'] - 1) * info.page['count'] + 1}} - {{info.page['total']}} of {{info.page['total']}}</pre> <a class="icon-arrow-right7 pagination-icon" title="Next Page" ng-click="nextPage()" ng-class="{'pagination-icon-disabled': (info.page['current'] >= info.page['pages'])}"></a> <a class="icon-next2 pagination-icon" title="Last Page" ng-click="lastPage()" ng-class="{'pagination-icon-disabled': (info.page['current'] >= info.page['pages'])}"></a> </span>
				<span class="pull-right">
				    <button type="button" class="btn-primary input-sm border-width-1 gb-rules-btn" ng-click="goToTestRuleHistory()">
                        Test Rule History
                    </button>
					<button type="button" class="btn-primary input-sm border-width-1 gb-rules-btn" ng-if="checkSelectedRules()" ng-click="goToTestRule()">
                        Test Rules
                    </button>
                    <button type="button" class="btn-primary input-sm border-width-1 gb-rules-btn-disabled" ng-hide="checkSelectedRules()">
                        Test Rules
                    </button>
					<button type="button" class="btn-primary input-sm border-width-1 gb-rules-btn" ng-click="addNewRule()">
						Add New
					</button> </span>
			</div>
		</div>
	</div>
	<div class="row-fluid" ng-hide="info.rulesLoading">
		<div class="col-sm-12 margin-top-10">
		    <span class="pull-right">
		        <span class="gb-rules-draft gb-rules-rectangle"></span>
                <span class="font-size-12 font-weight-bold">Draft</span>
                <span class="gb-rules-enabled gb-rules-rectangle margin-left-10"></span>
                <span class="font-size-12 font-weight-bold">Enabled</span>
                <!-- <span class="gb-rules-enabled-unsupported gb-rules-rectangle margin-left-10"></span>
                <span class="font-size-12 font-weight-bold">Enabled (Unsupported)</span> -->
                <span class="gb-rules-disabled gb-rules-rectangle margin-left-10"></span>
                <span class="font-size-12 font-weight-bold">Disabled</span>
                <!-- <span class="gb-rules-disabled-unsupported gb-rules-rectangle margin-left-10"></span>
                <span class="font-size-12 font-weight-bold">Disabled (Unsupported)</span> -->
		    </span>
		</div>
	</div>
</div>