"use strict";
exports.__esModule = true;
var testing_1 = require("@angular/core/testing");
var testing_2 = require("@angular/common/http/testing");
var admin_service_1 = require("./admin.service");
var api = require("../../shared/resource");
var user_tracking_service_1 = require("./user-tracking.service");
describe('AdminService', function () {
    var injector;
    var service;
    var httpMock;
    beforeEach(function () {
        document.cookie = "mps=siemens/siemens/podui";
        testing_1.TestBed.configureTestingModule({
            imports: [testing_2.HttpClientTestingModule],
            providers: [admin_service_1.AdminService]
        });
        injector = testing_1.getTestBed();
        service = injector.get(admin_service_1.AdminService);
        httpMock = injector.get(testing_2.HttpTestingController);
    });
    afterEach(function () {
        httpMock.verify();
    });
    it('should be created', function () {
        expect(service).toBeTruthy();
    });
    it('Getrolelist', function () {
        var userTracking = testing_1.TestBed.get(user_tracking_service_1.UserTrackingService);
        spyOn(userTracking, 'updateAccessTime').and.returnValue(true);
        var roleListApi = JSON.parse('{"Status":"Success","Msg":"list of all Users","Data":[{"name":"siemens_siemens_podui_admin","is_super":false,"domains":{"Siemens":"siemens/siemens/podui","Siemens_pod":"siemens/siemens/pod60"},"features":{"siemens/siemens/pod60":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","siemens/siemens/podui":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null,"siemens/siemens/pod60":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role9","is_super":false,"domains":{"Siemens":"siemens/siemens/podui","Siemens_pod":"siemens/siemens/pod60"},"features":{"siemens/siemens/pod60":"logvault,file_upload","siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null,"siemens/siemens/pod60":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role10","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_extrole1","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"healthcheck"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role4","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"admin","is_super":false,"domains":{},"features":{},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1","poc":"","gbstudio_spl":"","gbstudio_apps":""},"realm_uidomain":{"prod":"dev.glassbeam.com","poc":"","gbstudio_spl":"","gbstudio_apps":""},"mps_uidomain":{},"mps_isdomain":{},"realm_appsversion":{},"realm":["prod","poc","gbstudio_spl","gbstudio_apps"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role2","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"dashboards,dashboard_admin,logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role1","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"dashboards,logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role7","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role3","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"dashboards,logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role6","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role5","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0},{"name":"siemens_siemens_podui_role8","is_super":false,"domains":{"Siemens":"siemens/siemens/podui"},"features":{"siemens/siemens/podui":"logvault"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null},"realm":["prod"],"studio_proj_limit":0}]}');
        var expResult = JSON.parse('{"Status":"Success","Msg":"list of all Users","Data":[{"name":"siemens_siemens_podui_admin","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"featureData":[{"features":"Admin,Dashboards,File Upload,Rules & Alerts,Explorer,Logvault,Workbench,Rule Creator,Health Check,Dashboard Admin,Creator","featureKey":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator","featuresDis":["Admin","Creator","Dashboard Admin","Dashboards","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts","Workbench"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":true,"isViewer":false},{"features":"Admin,File Upload,Rules & Alerts,Explorer,Logvault,Rule Creator,Health Check","featureKey":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","featuresDis":["Admin","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts"],"mps":["siemens","siemens","pod60"],"name":"Siemens_pod","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Admin","Creator","Dashboard Admin","Dashboards","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts","Workbench"],"prodAssigned":["Siemens","Siemens_pod"],"selected":false,"colapsed":true,"DisName":"admin","roleType":"Internal"},{"name":"siemens_siemens_podui_role9","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false},{"features":"Logvault,File Upload","featureKey":"logvault,file_upload","featuresDis":["File Upload","Logvault"],"mps":["siemens","siemens","pod60"],"name":"Siemens_pod","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault","File Upload"],"prodAssigned":["Siemens","Siemens_pod"],"selected":false,"colapsed":true,"DisName":"role9","roleType":"Internal"},{"name":"siemens_siemens_podui_role10","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role10","roleType":"Internal"},{"name":"siemens_siemens_podui_extrole1","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Health Check","featureKey":"healthcheck","featuresDis":["Health Check"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Health Check"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"extrole1","roleType":"External"},{"name":"siemens_siemens_podui_role4","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role4","roleType":"Internal"},{"name":"siemens_siemens_podui_role2","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Dashboards,Dashboard Admin,Logvault","featureKey":"dashboards,dashboard_admin,logvault","featuresDis":["Dashboard Admin","Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Dashboard Admin","Dashboards","Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role2","roleType":"Internal"},{"name":"siemens_siemens_podui_role1","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Dashboards","Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role1","roleType":"Internal"},{"name":"siemens_siemens_podui_role7","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role7","roleType":"Internal"},{"name":"siemens_siemens_podui_role3","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Dashboards","Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role3","roleType":"Internal"},{"name":"siemens_siemens_podui_role6","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role6","roleType":"Internal"},{"name":"siemens_siemens_podui_role5","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role5","roleType":"Internal"},{"name":"siemens_siemens_podui_role8","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Logvault","featureKey":"logvault","featuresDis":["Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false,"isCreator":false,"isViewer":false}],"featuresAssigned":["Logvault"],"prodAssigned":["Siemens"],"selected":false,"colapsed":true,"DisName":"role8","roleType":"Internal"}]}');
        service.getRoleList().subscribe(function (data) {
            expect(data).toEqual(expResult);
        });
        var req = httpMock.expectOne(service.serverUrl + api.listRole + service.getMfr());
        expect(req.request.method).toBe("GET");
        req.flush(roleListApi);
    });
    it('getRoleListArray', function () {
        service.roleList = JSON.parse('[{"name":"siemens_siemens_podui_admin","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"featureData":[{"features":"Admin,Dashboards,File Upload,Rules & Alerts,Explorer,Logvault,Workbench,Rule Creator,Health Check,Dashboard Admin,Creator","featureKey":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator","featuresDis":["Admin","Creator","Dashboard Admin","Dashboards","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts","Workbench"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false},{"features":"Admin,File Upload,Rules & Alerts,Explorer,Logvault,Rule Creator,Health Check","featureKey":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","featuresDis":["Admin","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts"],"mps":["siemens","siemens","pod60"],"name":"Siemens_pod","selected":false}],"selected":false,"colapsed":true,"DisName":"admin","roleType":"Internal"},{"name":"siemens_siemens_podui_role2","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Dashboards,Dashboard Admin,Logvault","featureKey":"dashboards,dashboard_admin,logvault","featuresDis":["Dashboard Admin","Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"selected":false,"colapsed":true,"DisName":"role2","roleType":"Internal"},{"name":"siemens_siemens_podui_role1","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"selected":false,"colapsed":true,"DisName":"role1","roleType":"Internal"},{"name":"siemens_siemens_podui_role3","realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com"},"featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"selected":false,"colapsed":true,"DisName":"role3","roleType":"Internal"}]');
        var expValue = JSON.parse('[{"name":"siemens_siemens_podui_admin","disName":"admin","featureData":[{"features":"Admin,Dashboards,File Upload,Rules & Alerts,Explorer,Logvault,Workbench,Rule Creator,Health Check,Dashboard Admin,Creator","featureKey":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator","featuresDis":["Admin","Creator","Dashboard Admin","Dashboards","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts","Workbench"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false},{"features":"Admin,File Upload,Rules & Alerts,Explorer,Logvault,Rule Creator,Health Check","featureKey":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","featuresDis":["Admin","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts"],"mps":["siemens","siemens","pod60"],"name":"Siemens_pod","selected":false}],"roleType":"Internal"},{"name":"siemens_siemens_podui_role2","disName":"role2","featureData":[{"features":"Dashboards,Dashboard Admin,Logvault","featureKey":"dashboards,dashboard_admin,logvault","featuresDis":["Dashboard Admin","Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"roleType":"Internal"},{"name":"siemens_siemens_podui_role1","disName":"role1","featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"roleType":"Internal"},{"name":"siemens_siemens_podui_role3","disName":"role3","featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"roleType":"Internal"}]');
        var ret = service.getRoleListArray();
        expect(ret).toEqual(expValue);
    });
    it('fetchLoggedInUserDetails', function () {
        var userTracking = testing_1.TestBed.get(user_tracking_service_1.UserTrackingService);
        spyOn(userTracking, 'updateAccessTime').and.returnValue(true);
        var mps = service.getMPS().split('/');
        var userDetailsApi = JSON.parse('{"Status":"Success","Msg":"List all information for a user","Data":{"user":[{"email":"siemens@glassbeam.com","first_name":"Admin","end_customer":"NA","org":"siemens","role":"siemens_siemens_podui_admin","last_name":"User","def_passwd":false,"department":"NA","sso":false,"wb_user_name":"NA","report_usage":false,"created_on":"Mon Nov 11 15:33:17 IST 2019","active":true,"city":"NA","state":"NA","country":"NA","is_external":false,"mps_def":"siemens/siemens/podui","org_type":10,"show_info":false,"events_export_limit":0,"dashboard_admin":false}],"role_details":{"name":"siemens_siemens_podui_admin","is_super":false,"domains":{"Siemens":"siemens/siemens/podui","Siemens_pod":"siemens/siemens/pod60"},"features":{"siemens/siemens/pod60":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","siemens/siemens/podui":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null,"siemens/siemens/pod60":null},"realm":["prod"],"studio_proj_limit":0},"max_users":10,"max_licensed_users":5,"max_creator_licenses":2}}');
        var expResult = JSON.parse('{"user":[{"email":"siemens@glassbeam.com","first_name":"Admin","end_customer":"NA","org":"siemens","role":"siemens_siemens_podui_admin","last_name":"User","def_passwd":false,"department":"NA","sso":false,"wb_user_name":"NA","report_usage":false,"created_on":"Mon Nov 11 15:33:17 IST 2019","active":true,"city":"NA","state":"NA","country":"NA","is_external":false,"mps_def":"siemens/siemens/podui","org_type":10,"show_info":false,"events_export_limit":0,"dashboard_admin":false}],"role_details":{"name":"siemens_siemens_podui_admin","is_super":false,"domains":{"Siemens":"siemens/siemens/podui","Siemens_pod":"siemens/siemens/pod60"},"features":{"siemens/siemens/pod60":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","siemens/siemens/podui":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null,"siemens/siemens/pod60":null},"realm":["prod"],"studio_proj_limit":0},"max_users":10,"max_licensed_users":5,"max_creator_licenses":2}');
        service.fetchLoggedInUserDetails().subscribe(function (data) {
            expect(data).toEqual(expResult);
            expect(service.licensesData.maxUsers).toEqual(10);
            expect(service.licensesData.maxWBLicenses).toEqual(5);
            expect(service.licensesData.maxCreatorLicenses).toEqual(2);
        });
        var req = httpMock.expectOne(service.serverUrl + api.userdetails + mps[0] + '/' + mps[1] + '/' + mps[2]);
        expect(req.request.method).toBe("GET");
        req.flush(userDetailsApi);
    });
    it('getUserList', function () {
        var userTracking = testing_1.TestBed.get(user_tracking_service_1.UserTrackingService);
        spyOn(userTracking, 'updateAccessTime').and.returnValue(true);
        var userListApi = JSON.parse('{"Status":"Success","Msg":"List of users","Data":[{"email":"siemens@glassbeam.com","first_name":"Admin","last_name":"User","wb_user_name":"NA","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_admin","realm_def":"dev.glassbeam.com","end_customer":"NA","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"NA","phone":"NA","city":"NA","state":"NA","country":"NA","department":"NA","created_on":null,"modified_on":null,"last_login":"2019-11-13T11:46:37Z","is_external":false},{"email":"test2@user.com","first_name":"Test","last_name":"User 2","wb_user_name":"Generic","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role1","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$5MIds.eCAt99Ekf6WyvVd.8.eIAnKL.93GJ4qzOj5vKNl.x38TIni","phone":"456789","city":"dfghjk","state":"dfghjk","country":"dfghjk","department":"dfghj","created_on":"2019-11-08T08:21:34Z","modified_on":"2019-11-10T14:06:26Z","last_login":null,"is_external":false},{"email":"test3@user.com","first_name":"Test","last_name":"User 3","wb_user_name":"Generic","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role1","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$MTW51rOMLzOn3CS7pbwqdeAjT9HRLV20heHD8Xj5dPGPpuyj6jeXK","phone":"4567","city":"fghjk","state":"fghjk","country":"fghjk","department":"dfghj","created_on":"2019-11-08T08:22:34Z","modified_on":null,"last_login":null,"is_external":false},{"email":"test@test.con","first_name":"Test User","last_name":"Test","wb_user_name":"Generic","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role1","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$bTv9X0qFoyJXI25JrIjqseZeo.0Bv7zigmuBxLpxoVbVcemi2xIje","phone":"34567890","city":"fghjkl","state":"ghjkl","country":"fghjkl","department":"dfghj","created_on":"2019-11-06T06:52:10Z","modified_on":null,"last_login":null,"is_external":false},{"email":"test@user.com","first_name":"Test","last_name":"USer 1","wb_user_name":"test@user.com","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role2","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$w/m8xS0Rfxpn5D8RpNKl4e.0eOt7txXjkb5UoB1E4eFs9A5IEpXsu","phone":"3456789","city":"dfghjkl","state":"dfghjkl","country":"fgkl","department":"dfghjk","created_on":"2019-11-08T08:19:40Z","modified_on":null,"last_login":null,"is_external":false}]}');
        var expResult = JSON.parse('[{"email":"siemens@glassbeam.com","first_name":"Admin","last_name":"User","wb_user_name":"NA","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_admin","realm_def":"dev.glassbeam.com","end_customer":"NA","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"NA","phone":"NA","city":"NA","state":"NA","country":"NA","department":"NA","created_on":null,"modified_on":null,"last_login":"2019-11-13T11:46:37Z","is_external":false,"roleName":"admin","adminUser":true,"selected":false},{"email":"test2@user.com","first_name":"Test","last_name":"User 2","wb_user_name":"Generic","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role1","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$5MIds.eCAt99Ekf6WyvVd.8.eIAnKL.93GJ4qzOj5vKNl.x38TIni","phone":"456789","city":"dfghjk","state":"dfghjk","country":"dfghjk","department":"dfghj","created_on":"2019-11-08T08:21:34Z","modified_on":"2019-11-10T14:06:26Z","last_login":null,"is_external":false,"roleName":"role1","adminUser":false,"selected":false},{"email":"test3@user.com","first_name":"Test","last_name":"User 3","wb_user_name":"Generic","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role1","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$MTW51rOMLzOn3CS7pbwqdeAjT9HRLV20heHD8Xj5dPGPpuyj6jeXK","phone":"4567","city":"fghjk","state":"fghjk","country":"fghjk","department":"dfghj","created_on":"2019-11-08T08:22:34Z","modified_on":null,"last_login":null,"is_external":false,"roleName":"role1","adminUser":false,"selected":false},{"email":"test@test.con","first_name":"Test User","last_name":"Test","wb_user_name":"Generic","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role1","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$bTv9X0qFoyJXI25JrIjqseZeo.0Bv7zigmuBxLpxoVbVcemi2xIje","phone":"34567890","city":"fghjkl","state":"ghjkl","country":"fghjkl","department":"dfghj","created_on":"2019-11-06T06:52:10Z","modified_on":null,"last_login":null,"is_external":false,"roleName":"role1","adminUser":false,"selected":false},{"email":"test@user.com","first_name":"Test","last_name":"USer 1","wb_user_name":"test@user.com","report_usage":false,"org":"siemens","role":"siemens_siemens_podui_role2","realm_def":"dev.glassbeam.com","end_customer":"","mps_def":"siemens/siemens/podui","dashboard_admin":false,"active":true,"token_id":"$2a$10$w/m8xS0Rfxpn5D8RpNKl4e.0eOt7txXjkb5UoB1E4eFs9A5IEpXsu","phone":"3456789","city":"dfghjkl","state":"dfghjkl","country":"fgkl","department":"dfghjk","created_on":"2019-11-08T08:19:40Z","modified_on":null,"last_login":null,"is_external":false,"roleName":"role2","adminUser":false,"selected":false}]');
        service.licensesData = JSON.parse('{"maxUsers":10,"maxWBLicenses":5,"maxCreatorLicenses":2,"totalUsers":5,"workbenchLicensedUsed":1,"creatorLicensesUsed":1}');
        service.loggedInUserDetails = JSON.parse('{"user":[{"email":"siemens@glassbeam.com","first_name":"Admin","end_customer":"NA","org":"siemens","role":"siemens_siemens_podui_admin","last_name":"User","def_passwd":false,"department":"NA","sso":false,"wb_user_name":"NA","report_usage":false,"created_on":"Mon Nov 11 15:33:17 IST 2019","active":true,"city":"NA","state":"NA","country":"NA","is_external":false,"mps_def":"siemens/siemens/podui","org_type":10,"show_info":false,"events_export_limit":0,"dashboard_admin":false}],"role_details":{"name":"siemens_siemens_podui_admin","is_super":false,"domains":{"Siemens":"siemens/siemens/podui","Siemens_pod":"siemens/siemens/pod60"},"features":{"siemens/siemens/pod60":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","siemens/siemens/podui":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator"},"realm_isdomain":{"prod":"http://dev.glassbeam.com:9000/v1"},"realm_uidomain":{"prod":"dev.glassbeam.com"},"mps_uidomain":{"siemens/siemens/podui":"dev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com"},"mps_isdomain":{"siemens/siemens/podui":"http://dev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://dev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens/siemens/podui":null,"siemens/siemens/pod60":null},"realm":["prod"],"studio_proj_limit":0},"max_users":10,"max_licensed_users":5,"max_creator_licenses":2}');
        var roleListValue = JSON.parse('[{"name":"siemens_siemens_podui_admin","disName":"admin","featureData":[{"features":"Admin,Dashboards,File Upload,Rules & Alerts,Explorer,Logvault,Workbench,Rule Creator,Health Check,Dashboard Admin,Creator","featureKey":"admin,dashboards,file_upload,rules_and_alerts,explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin,wb_creator","featuresDis":["Admin","Creator","Dashboard Admin","Dashboards","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts","Workbench"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false},{"features":"Admin,File Upload,Rules & Alerts,Explorer,Logvault,Rule Creator,Health Check","featureKey":"admin,file_upload,rules_and_alerts,explorer,logvault,rule_creator,healthcheck","featuresDis":["Admin","Explorer","File Upload","Health Check","Logvault","Rule Creator","Rules & Alerts"],"mps":["siemens","siemens","pod60"],"name":"Siemens_pod","selected":false}],"roleType":"Internal"},{"name":"siemens_siemens_podui_role2","disName":"role2","featureData":[{"features":"Dashboards,Dashboard Admin,Logvault","featureKey":"dashboards,dashboard_admin,logvault","featuresDis":["Dashboard Admin","Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"roleType":"Internal"},{"name":"siemens_siemens_podui_role1","disName":"role1","featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"roleType":"Internal"},{"name":"siemens_siemens_podui_role3","disName":"role3","featureData":[{"features":"Dashboards,Logvault","featureKey":"dashboards,logvault","featuresDis":["Dashboards","Logvault"],"mps":["siemens","siemens","podui"],"name":"Siemens","selected":false}],"roleType":"Internal"}]');
        spyOn(service, 'getRoleListArray').and.returnValue(roleListValue);
        service.getUserList().subscribe(function (data) {
            expect(data).toEqual(expResult);
        });
        var req = httpMock.expectOne(service.serverUrl + api.listUser + service.getMfr());
        expect(req.request.method).toBe("GET");
        req.flush(userListApi);
    });
    it('GetEndCustomerList', function () {
        var userTracking = testing_1.TestBed.get(user_tracking_service_1.UserTrackingService);
        spyOn(userTracking, 'updateAccessTime').and.returnValue(true);
        var endCustListApi = JSON.parse('{"Status":"Success","Msg":"List all information for a user","Data":[{"mfr":"siemens","prod":"siemens","sch":"podui","endcustomer_name":"12345","serial_number":["ct64724","ct60111","ct60279","ct66930","ct64835"],"created_by":"nishanth@glassbeam.com","updated_on":"2019-09-19T11:55:44Z","selected":false}]}');
        var expResult = JSON.parse('{"Status":"Success","Msg":"List all information for a user","Data":[{"mfr":"siemens","prod":"siemens","sch":"podui","endcustomer_name":"12345","serial_number":["ct64724","ct60111","ct60279","ct66930","ct64835"],"created_by":"nishanth@glassbeam.com","updated_on":"2019-09-19T11:55:44Z","selected":false}]}');
        service.getendCustomerList().subscribe(function (data) {
            expect(data).toEqual(expResult);
        });
        var req = httpMock.expectOne(service.serverUrl + api.listEndCustomer + service.getMfr());
        expect(req.request.method).toBe("GET");
        req.flush(endCustListApi);
    });
    it('GetProductList', function () {
        var userTracking = testing_1.TestBed.get(user_tracking_service_1.UserTrackingService);
        spyOn(userTracking, 'updateAccessTime').and.returnValue(true);
        var productListApi = JSON.parse('{"user":[{"email":"siemensqa@glassbeam.com","first_name":"Ritesh","end_customer":"","org":"glassbeam","role":"siemens_siemens_podui_admin","last_name":"NA","def_passwd":false,"department":"NA","sso":false,"wb_user_name":"siemensqa@glassbeam.com","report_usage":false,"created_on":"Fri Sep 20 12:48:49 UTC 2019","active":true,"city":"NA","state":"NA","country":"NA","is_external":false,"mps_def":"siemens/siemens/podui","org_type":1000,"show_info":false,"events_export_limit":300,"dashboard_admin":true}],"role_details":{"name":"siemens_siemens_podui_admin","is_super":false,"domains":{"SIEMENS":"siemens/siemens/podui"},"features":{"siemens/siemens/pod":"admin,explorer,logvault","siemens:siemenswh:podv10":"admin,explorer,logvault,healthcheck","default:default:default":"workbench,explorer,logvault,admin","siemens/siemens/pod60":"dashboards,file_upload,rules_and_alerts,explorer,logvault,admin,healthcheck","siemens/siemens/podui":"admin,dashboards,file_upload,rules_and_alerts, explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin"},"realm_isdomain":{"qaui":"http://searchdev.glassbeam.com:9000/v1","stage":"","autostage":"http://autostage.glassbeam.com:9000/v1"},"realm_uidomain":{"qaui":"dev.glassbeam.com","stage":"","autostage":"autostage.glassbeam.com"},"mps_uidomain":{"siemens:siemenswh:podv10":"searchdev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com","siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens:siemenswh:podv10":"http://searchdev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://searchdev.glassbeam.com:9000/v1","siemens/siemens/podui":"http://searchdev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens:siemenswh:podv10":"5.5","siemens/siemens/pod60":"6.1","siemens/siemens/podui":"6.1"},"realm":["qaui","stage","autostage"],"studio_proj_limit":0},"max_users":20,"max_licensed_users":10,"max_creator_licenses":2}');
        var expResult = JSON.parse('{"user":[{"email":"siemensqa@glassbeam.com","first_name":"Ritesh","end_customer":"","org":"glassbeam","role":"siemens_siemens_podui_admin","last_name":"NA","def_passwd":false,"department":"NA","sso":false,"wb_user_name":"siemensqa@glassbeam.com","report_usage":false,"created_on":"Fri Sep 20 12:48:49 UTC 2019","active":true,"city":"NA","state":"NA","country":"NA","is_external":false,"mps_def":"siemens/siemens/podui","org_type":1000,"show_info":false,"events_export_limit":300,"dashboard_admin":true}],"role_details":{"name":"siemens_siemens_podui_admin","is_super":false,"domains":{"SIEMENS":"siemens/siemens/podui"},"features":{"siemens/siemens/pod":"admin,explorer,logvault","siemens:siemenswh:podv10":"admin,explorer,logvault,healthcheck","default:default:default":"workbench,explorer,logvault,admin","siemens/siemens/pod60":"dashboards,file_upload,rules_and_alerts,explorer,logvault,admin,healthcheck","siemens/siemens/podui":"admin,dashboards,file_upload,rules_and_alerts, explorer,logvault,workbench,rule_creator,healthcheck,dashboard_admin"},"realm_isdomain":{"qaui":"http://searchdev.glassbeam.com:9000/v1","stage":"","autostage":"http://autostage.glassbeam.com:9000/v1"},"realm_uidomain":{"qaui":"dev.glassbeam.com","stage":"","autostage":"autostage.glassbeam.com"},"mps_uidomain":{"siemens:siemenswh:podv10":"searchdev.glassbeam.com","siemens/siemens/pod60":"dev.glassbeam.com","siemens/siemens/podui":"dev.glassbeam.com"},"mps_isdomain":{"siemens:siemenswh:podv10":"http://searchdev.glassbeam.com:9000/v1","siemens/siemens/pod60":"http://searchdev.glassbeam.com:9000/v1","siemens/siemens/podui":"http://searchdev.glassbeam.com:9000/v1"},"realm_appsversion":{"siemens:siemenswh:podv10":"5.5","siemens/siemens/pod60":"6.1","siemens/siemens/podui":"6.1"},"realm":["qaui","stage","autostage"],"studio_proj_limit":0},"max_users":20,"max_licensed_users":10,"max_creator_licenses":2}');
        service.getProductListApi().subscribe(function (data) {
            expect(data.Data).toEqual(expResult);
        });
        var req = httpMock.expectOne(service.serverUrl + api.userdetails + 'siemens/siemens/podui');
        expect(req.request.method).toBe("GET");
        req.flush(productListApi);
    });
    it('SysIdList', function () {
        service.groupedDataEndCustomer = {
            "siemens/siemens/podui": [
                {
                    "mfr": "siemens",
                    "prod": "siemens",
                    "sch": "podui",
                    "endcustomer_name": "Group A",
                    "serial_number": [
                        "CT64492",
                        "CT60503"
                    ],
                    "created_by": "siemens@glassbeam.com",
                    "updated_on": "2019-11-03T12:30:03Z",
                    "selected": false
                }
            ]
        };
        service.sysIdList = [{ name: "CT65225", selected: false }, { name: "CT64352", selected: false }];
        ;
        // service.unavailableSysids = [];
        var prodName = 'siemens/siemens/podui';
        var mockurl = './../../../assets/mockData/admin/';
        var productListApi = [{ name: "CT65225", selected: false }, { name: "CT64352", selected: false }];
        var expResult = [{ name: "CT65225", selected: false }, { name: "CT64352", selected: false }];
        service.getSysList(prodName, 0, 10, {}).subscribe(function (data) {
            expect(service.sysIdList).toEqual(service.sysIdList);
        });
        var req = httpMock.expectOne(mockurl + "sysidList.json");
        expect(req.request.method).toBe("GET");
        req.flush(productListApi);
    });
});
